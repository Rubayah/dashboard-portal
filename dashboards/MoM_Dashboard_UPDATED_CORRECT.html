<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoM Revenue Dashboard - April to December 2025</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f7fa; padding: 20px; overflow-x: hidden; }
        .container { max-width: 1400px; margin: 0 auto; overflow: visible; }
        .header { background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 30px; border-radius: 12px; text-align: center; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(5, 150, 105, 0.2); }
        .header h1 { font-size: 2.2em; margin-bottom: 8px; font-weight: 600; }
        .header p { font-size: 1em; opacity: 0.95; font-weight: 300; }
        
        .section { background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 20px rgba(0,0,0,0.08); overflow: visible; }
        .section-title { font-size: 1.5em; color: #1e293b; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 3px solid; font-weight: 600; }
        .section-title.total { border-bottom-color: #10b981; }
        .section-title.product { border-bottom-color: #3b82f6; }
        .section-title.consumables { border-bottom-color: #f59e0b; }
        .section-title.gc { border-bottom-color: #8b5cf6; }
        .section-title.rc { border-bottom-color: #ec4899; }
        
        .metrics-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 24px; }
        .metric-box { background: linear-gradient(135deg, #fafbfc 0%, #f1f5f9 100%); padding: 20px; border-radius: 10px; border-left: 5px solid; box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: transform 0.2s; }
        .metric-box:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .metric-box.april { border-left-color: #3b82f6; }
        .metric-box.december { border-left-color: #10b981; }
        .metric-box.new { border-left-color: #f59e0b; }
        .metric-box.growth { border-left-color: #8b5cf6; }
        .metric-label { font-size: 0.85em; color: #64748b; text-transform: uppercase; margin-bottom: 8px; font-weight: 600; letter-spacing: 0.5px; }
        .metric-value { font-size: 2em; font-weight: 700; color: #1e293b; margin-bottom: 4px; }
        .metric-sub { font-size: 0.85em; color: #64748b; margin-top: 8px; padding-top: 8px; border-top: 1px solid #e2e8f0; }
        
        .insights { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); color: white; padding: 30px; margin: 30px 0; border-radius: 12px; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); }
        .insights h2 { font-size: 1.6em; margin-bottom: 20px; font-weight: 600; }
        .insights ul { list-style: none; padding-left: 0; }
        .insights li { padding: 10px 0; padding-left: 28px; position: relative; font-size: 1em; line-height: 1.7; font-weight: 300; }
        .insights li:before { content: "â†’"; position: absolute; left: 0; font-weight: bold; font-size: 1.2em; }
        .insights li strong { font-weight: 600; }
        
        @media (max-width: 768px) { .metrics-row { grid-template-columns: 1fr 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš€ MoM Revenue Dashboard</h1>
            <p>April - December 2025 | Cohort Attribution & Growth Analysis</p>
        </div>
        
        <!-- MONTHLY REVENUE GROWTH OVERVIEW -->
        <div class="section">
            <div class="section-title total">ðŸ“ˆ Monthly Revenue Growth Overview</div>
            <canvas id="monthlyGrowthChart" height="80"></canvas>
        </div>
        
        <!-- TOTAL MRR SECTION -->
        <div class="section">
            <div class="section-title total">ðŸ“Š Revenue Attribution - April Cohort vs New Accounts</div>
            
            <div class="metrics-row">
                <div class="metric-box april">
                    <div class="metric-label">April Baseline Accounts</div>
                    <div class="metric-value">172</div>
                    <div class="metric-sub">Total accounts<br>68 Focus + 104 RC<br>45.12M revenue</div>
                </div>
                <div class="metric-box december">
                    <div class="metric-label">December Total Accounts</div>
                    <div class="metric-value">211</div>
                    <div class="metric-sub">Active accounts<br>85 Focus + 126 RC<br>495.2M total revenue<br>68.86M in Dec</div>
                </div>
                <div class="metric-box new">
                    <div class="metric-label">Gross New Accounts</div>
                    <div class="metric-value">+54</div>
                    <div class="metric-sub">Added May-Dec<br>19 Focus + 35 RC<br>7.21M total revenue</div>
                </div>
                <div class="metric-box growth">
                    <div class="metric-label">Total Growth</div>
                    <div class="metric-value">+52.6%</div>
                    <div class="metric-sub">45.12M â†’ 68.86M<br>+23.74M added</div>
                </div>
            </div>
            
            <canvas id="totalMrrChart" height="120"></canvas>
        </div>
        
        <!-- PRODUCT+PS SECTION -->
        <div class="section">
            <div class="section-title product">Product + PS Revenue</div>
            <canvas id="productPsChart" height="120"></canvas>
        </div>
        
        <!-- CONSUMABLES SECTION -->
        <div class="section">
            <div class="section-title consumables">Consumables Revenue</div>
            <canvas id="consumablesChart" height="120"></canvas>
        </div>
        
        <!-- GC PERSON-WISE -->
        <div class="section">
            <div class="section-title gc">ðŸ“Š All GC Persons - Total Revenue (Apr-Dec 2025)</div>
            <canvas id="gcPersonChart" height="200"></canvas>
        </div>
        
        <!-- RC PERSON-WISE -->
        <div class="section">
            <div class="section-title rc">ðŸ“Š All RC Persons - Total Revenue (Apr-Dec 2025)</div>
            <canvas id="rcPersonChart" height="160"></canvas>
        </div>
        
        <!-- INSIGHTS -->
        <div class="insights">
            <h2>ðŸ“Š Key MoM Insights</h2>
            <ul>
                <li><strong>Strong Incremental Growth:</strong> Revenue grew 52.6% from 45.12M (April) to 68.86M (December), driven by stable April cohort (45.80M in Dec) and 54 gross new accounts (19 Focus + 35 RC) contributing 7.21M cumulatively.</li>
                
                <li><strong>April Cohort Retention:</strong> Original 172 accounts (68 Focus + 104 RC) maintained 45.80M in December vs 45.12M in April (+1.5%), showing excellent baseline retention with minimal net churn.</li>
                
                <li><strong>Top GC Performers:</strong> Princy Choudhary leads with 62.09M YTD, growing from 4.43M (Apr) to 13.67M (Dec) â€” a +209% jump. Sidharth Sanjeev follows at 51.80M YTD (+115% Aprâ†’Dec).</li>
                
                <li><strong>Product+PS Drives Growth:</strong> Product and Professional Services grew from 39.86M to 58.84M (+47.6%), with new accounts contributing 17.90M (30.4% of Dec total). Core offering remains strong.</li>
                
                <li><strong>Consumables Volatility:</strong> Consumables fluctuated significantly (5.26M â†’ 10.01M), with new accounts contributing 5.16M in December (51.5%). Presents both opportunity and risk.</li>
                
                <li><strong>RC Side Growth:</strong> Himanshi Verma is fastest RC grower at 22.32M YTD: 1.50M â†’ 3.21M (+114% Aprâ†’Dec). Dashmesh Singh stable at 25.44M YTD.</li>
            </ul>
        </div>
    </div>
    
    <script>
        const colors = {
            aprilCohort: '#3b82f6',
            mayJoiners: '#10b981',
            junJoiners: '#14b8a6',
            julJoiners: '#8b5cf6',
            augJoiners: '#ec4899',
            sepJoiners: '#f59e0b',
            octJoiners: '#ef4444',
            novJoiners: '#06b6d4',
            decJoiners: '#84cc16'
        };
        
        const months = ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        // Total Revenue data
        const totalRevenue = [45.12, 48.96, 48.12, 48.08, 52.66, 57.81, 60.85, 64.75, 68.86];
        const aprilCohortTotal = [45.12, 48.39, 46.84, 45.31, 46.27, 47.72, 47.93, 48.22, 45.80];
        
        // MEA vs RC breakdown
        const meaTotal = [26.47, 28.92, 27.81, 26.80, 30.53, 35.61, 37.85, 41.24, 46.44];
        const rcTotal = [18.65, 20.04, 20.31, 21.27, 22.13, 22.20, 23.00, 23.51, 22.42];
        
        // Incremental new joiners persisting through months (calculated to match totalRevenue bar heights)
        const mayJoiners = [0, 0.57, 0.57, 0.57, 0.57, 0.57, 0.57, 0.57, 0.57];
        const junJoiners = [0, 0, 0.71, 0.71, 0.71, 0.71, 0.71, 0.71, 0.71];
        const julJoiners = [0, 0, 0, 1.49, 1.49, 1.49, 1.49, 1.49, 1.49];
        const augJoiners = [0, 0, 0, 0, 3.62, 3.62, 3.62, 3.62, 3.62];
        const sepJoiners = [0, 0, 0, 0, 0, 3.70, 3.70, 3.70, 3.70];
        const octJoiners = [0, 0, 0, 0, 0, 0, 2.83, 2.83, 2.83];
        const novJoiners = [0, 0, 0, 0, 0, 0, 0, 3.61, 3.61];
        const decJoiners = [0, 0, 0, 0, 0, 0, 0, 0, 6.53];
        
        // Joiner counts for tooltip (Focus + RC in brackets)
        // Format: [Focus joiners, RC joiners, Total joiners]
        const joinerCounts = {
            may: [1, 5, 6],      // From Joiners_MEA, Joiners_RC, Joiners_Total
            jun: [0, 2, 2],
            jul: [5, 3, 8],
            aug: [2, 4, 6],
            sep: [5, 5, 10],
            oct: [0, 5, 5],
            nov: [4, 0, 4],
            dec: [2, 11, 13]
        };
        
        // Monthly new joiner revenue (New Accounts Total from screenshot) in 
        const newAccountsRevenue = [
            0,              // April (baseline)
            545833.6001,    // May
            74032.74214,    // June
            1333736.261,    // July
            733618.8163,    // August
            2528181.846,    // September
            520762.0115,    // October
            640888.015,     // November
            832923.6395     // December
        ];
        
        // Product+PS data (from updated table - Screenshot 2026-02-03 1:44:04 PM)
        const productTotal = [39.86, 42.44, 40.54, 42.48, 48.35, 50.01, 54.33, 56.38, 58.84];
        const productCohort = [39.857, 42.136, 40.473, 41.592, 46.440, 48.881, 51.588, 56.230, 58.202];
        
        // Focus vs RC breakdown for Product+PS
        const productFocus = [22.92, 24.52, 22.90, 23.22, 27.27, 28.95, 32.31, 34.27, 37.59];
        const productRC = [16.94, 17.92, 17.63, 19.25, 21.08, 21.06, 22.01, 22.11, 21.26];
        
        // New Accounts for Product+PS (cumulative persisting amounts)
        const productNewAccounts = [0, 0.30214, 0.06575, 0.88708, 1.91197, 1.13108, 2.73762, 0.15395, 0.64309];
        
        // Correct incremental joiners for Product+PS - each month's new accounts persist
        const productMayJoiners = [0, 0.30214, 0.30214, 0.30214, 0.30214, 0.30214, 0.30214, 0.30214, 0.30214];
        const productJunJoiners = [0, 0, 0.06575, 0.06575, 0.06575, 0.06575, 0.06575, 0.06575, 0.06575];
        const productJulJoiners = [0, 0, 0, 0.88708, 0.88708, 0.88708, 0.88708, 0.88708, 0.88708];
        const productAugJoiners = [0, 0, 0, 0, 1.91197, 1.91197, 1.91197, 1.91197, 1.91197];
        const productSepJoiners = [0, 0, 0, 0, 0, 1.13108, 1.13108, 1.13108, 1.13108];
        const productOctJoiners = [0, 0, 0, 0, 0, 0, 2.73762, 2.73762, 2.73762];
        const productNovJoiners = [0, 0, 0, 0, 0, 0, 0, 0.15395, 0.15395];
        const productDecJoiners = [0, 0, 0, 0, 0, 0, 0, 0, 0.64309];
        
        // Consumables data (from updated table - Screenshot 2026-02-03 1:05:54 PM)
        const consumablesTotal = [5.26, 6.52, 7.58, 5.60, 4.31, 7.80, 6.52, 8.37, 10.01];
        const consumablesCohort = [5.26, 6.36, 7.58, 5.56, 4.29, 7.80, 6.47, 8.25, 9.81];
        
        // Focus vs RC breakdown for Consumables
        const consumablesFocus = [3.56, 4.39, 4.91, 3.58, 3.27, 6.66, 5.54, 6.97, 8.86];
        const consumablesRC = [1.71, 2.13, 2.68, 2.02, 1.04, 1.14, 0.98, 1.40, 1.16];
        
        // New Accounts for Consumables (cumulative persisting amounts)
        const consumablesNewAccounts = [0, 0.15458, 0.00470, 0.04053, 0.02247, 0.00000, 0.04794, 0.11669, 0.20065];
        
        // Correct incremental joiners for Consumables - each month's new accounts persist
        const consumablesMayJoiners = [0, 0.15458, 0.15458, 0.15458, 0.15458, 0.15458, 0.15458, 0.15458, 0.15458];
        const consumablesJunJoiners = [0, 0, 0.00470, 0.00470, 0.00470, 0.00470, 0.00470, 0.00470, 0.00470];
        const consumablesJulJoiners = [0, 0, 0, 0.04053, 0.04053, 0.04053, 0.04053, 0.04053, 0.04053];
        const consumablesAugJoiners = [0, 0, 0, 0, 0.02247, 0.02247, 0.02247, 0.02247, 0.02247];
        const consumablesSepJoiners = [0, 0, 0, 0, 0, 0.00000, 0.00000, 0.00000, 0.00000];
        const consumablesOctJoiners = [0, 0, 0, 0, 0, 0, 0.04794, 0.04794, 0.04794];
        const consumablesNovJoiners = [0, 0, 0, 0, 0, 0, 0, 0.11669, 0.11669];
        const consumablesDecJoiners = [0, 0, 0, 0, 0, 0, 0, 0, 0.20065];
        
        // GC Person data
        const gcPersons = ['Princy Choudhary', 'Sidharth Sanjeev', 'Aditi Jannu', 'Rohan Ratna', 'Ankita Shinde', 'Mark Brian', 'Rishika Sharma', 'Saurabh Yadav', 'Saharsh Jhawar', 'Rajas Bhagat', 'Vipin Aniyath', 'Aarushi Handa'];
        const gcApril = [4.43, 4.23, 4.07, 3.48, 3.11, 3.34, 1.45, 1.47, 0.00, 0.23, 0.25, 0.00];
        const gcDec = [13.67, 9.11, 4.74, 4.63, 4.62, 1.61, 2.30, 2.88, 0.82, 0.31, 0.28, 0.86];
        const gcYTD = [62.09, 51.80, 39.48, 34.34, 29.73, 26.45, 21.30, 20.99, 5.11, 2.61, 2.49, 1.90];
        
        // RC Person data
        const rcPersons = ['Dashmesh Singh', 'Himanshi Verma', 'Vineet Jain', 'Philip Mathew', 'Divya Shivakumar', 'Simran Kapoor', 'Padmini Deshpande', 'Saharsh Jhawar'];
        const rcApril = [2.58, 1.50, 1.91, 0.72, 0.45, 0.27, 0.08, 0.00];
        const rcDec = [2.98, 3.21, 1.63, 0.98, 0.89, 0.40, 0.09, 0.00];
        const rcYTD = [25.44, 22.32, 15.37, 9.23, 8.84, 3.30, 0.78, 0.40];
        
        // Chart 1: Monthly Growth Overview
        new Chart(document.getElementById('monthlyGrowthChart'), {
            type: 'bar',
            data: {
                labels: months,
                datasets: [
                    {
                        label: 'Total Revenue',
                        data: totalRevenue,
                        backgroundColor: [
                            'rgba(100, 116, 139, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(16, 185, 129, 0.8)'
                        ],
                        borderWidth: 0
                    },
                    {
                        type: 'line',
                        label: 'MoM Growth %',
                        data: [null, 8.50, -1.72, -0.10, 9.54, 9.77, 5.25, 6.41, 6.35],
                        borderColor: 'rgb(139, 92, 246)',
                        borderWidth: 3,
                        yAxisID: 'y1',
                        tension: 0.4,
                        pointRadius: 6
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top', labels: { usePointStyle: true, padding: 20, font: { size: 12, weight: '600' } } },
                    tooltip: {
                        backgroundColor: 'rgba(30, 41, 59, 1)',
                        padding: 14,
                        callbacks: {
                            label: function(context) {
                                if (context.datasetIndex === 0) return 'Revenue: ' + context.parsed.y.toFixed(2) + 'M';
                                else { if (context.parsed.y === null) return null; return 'Growth: ' + (context.parsed.y > 0 ? '+' : '') + context.parsed.y.toFixed(2) + '%'; }
                            }
                        }
                    }
                },
                scales: {
                    y: { position: 'left', beginAtZero: true, ticks: { callback: v => v + 'M' } },
                    y1: { position: 'right', grid: { drawOnChartArea: false }, ticks: { callback: v => v + '%' } },
                    x: { grid: { display: false } }
                }
            }
        });
        
        // Chart 2: Total Revenue Stacked (REDUCED HEIGHT)
        new Chart(document.getElementById('totalMrrChart'), {
            type: 'bar',
            data: {
                labels: months,
                datasets: [
                    {
                        label: 'April Baseline (172 accounts)',
                        data: aprilCohortTotal,
                        backgroundColor: colors.aprilCohort,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'May (6 new)',
                        data: mayJoiners,
                        backgroundColor: colors.mayJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'June (2 new)',
                        data: junJoiners,
                        backgroundColor: colors.junJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'July (8 new)',
                        data: julJoiners,
                        backgroundColor: colors.julJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'August (6 new)',
                        data: augJoiners,
                        backgroundColor: colors.augJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'September (10 new)',
                        data: sepJoiners,
                        backgroundColor: colors.sepJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'October (5 new)',
                        data: octJoiners,
                        backgroundColor: colors.octJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'November (4 new)',
                        data: novJoiners,
                        backgroundColor: colors.novJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'December (13 new)',
                        data: decJoiners,
                        backgroundColor: colors.decJoiners,
                        borderWidth: 0,
                        borderRadius: { topLeft: 8, topRight: 8 },
                        borderSkipped: false
                    }
                ]
            },
            plugins: [{
                id: 'topLabels',
                afterDatasetsDraw(chart) {
                    const { ctx, scales: { x, y } } = chart;
                    ctx.save();
                    ctx.font = 'bold 13px Segoe UI';
                    ctx.fillStyle = '#1e293b';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';
                    
                    chart.data.labels.forEach((label, index) => {
                        const total = totalRevenue[index];
                        const xPos = x.getPixelForValue(index);
                        const yPos = y.getPixelForValue(total);
                        ctx.fillText(total.toFixed(1) + 'M', xPos, yPos - 8);
                    });
                    
                    ctx.restore();
                }
            }],
            options: {
                responsive: true,
                maintainAspectRatio: true,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { 
                        position: 'top', 
                        labels: { 
                            boxWidth: 12, 
                            font: { size: 10, weight: '600' }, 
                            padding: 10,
                            usePointStyle: true,
                            pointStyle: 'circle'
                        } 
                    },
                    tooltip: {
                        position: 'nearest',
                        yAlign: 'top',
                        xAlign: 'center',
                        caretPadding: 8,
                        backgroundColor: 'rgba(30, 41, 59, 0.98)',
                        padding: 16,
                        bodyFont: { size: 12, family: 'monospace' },
                        callbacks: {
                            title: function(items) {
                                const idx = items[0].dataIndex;
                                const lines = [
                                    items[0].label + ' 2025',
                                    'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
                                    'Total Revenue: ' + totalRevenue[idx].toFixed(1) + 'M',
                                    '  MEA Focus: ' + meaTotal[idx].toFixed(2) + 'M',
                                    '  RC MEA: ' + rcTotal[idx].toFixed(2) + 'M'
                                ];
                                
                                // Add new accounts revenue for May onwards
                                if (idx > 0) {
                                    const newAccRev = newAccountsRevenue[idx];
                                    
                                    // Format revenue: always use K
                                    const formatRevenue = (val) => {
                                        if (val === 0) return '0';
                                        return '' + (val / 1000).toFixed(1) + 'K';
                                    };
                                    
                                    lines.push('');
                                    lines.push('New Accounts: ' + formatRevenue(newAccRev));
                                }
                                
                                return lines;
                            },
                            label: function(c) {
                                if (c.parsed.y === 0) return null;
                                return c.dataset.label + ': ' + c.parsed.y.toFixed(2) + 'M';
                            }
                        }
                    }
                },
                scales: {
                    x: { 
                        stacked: true, 
                        grid: { display: false }, 
                        ticks: { 
                            font: { weight: 'bold', size: 12 },
                            color: '#334155'
                        }
                    },
                    y: { 
                        stacked: true, 
                        beginAtZero: true, 
                        max: 80,
                        ticks: { 
                            callback: v => '' + v + 'M',
                            font: { size: 11 },
                            color: '#64748b'
                        },
                        grid: { 
                            color: 'rgba(148, 163, 184, 0.1)',
                            drawBorder: false
                        },
                        border: { display: false }
                    }
                }
            }
        });
        
        // Chart 3: Product+PS Stacked (SAME HEIGHT AS TOTAL)
        new Chart(document.getElementById('productPsChart'), {
            type: 'bar',
            data: {
                labels: months,
                datasets: [
                    {
                        label: 'April Cohort',
                        data: productCohort,
                        backgroundColor: colors.aprilCohort,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'May Joiners',
                        data: productMayJoiners,
                        backgroundColor: colors.mayJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'June Joiners',
                        data: productJunJoiners,
                        backgroundColor: colors.junJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'July Joiners',
                        data: productJulJoiners,
                        backgroundColor: colors.julJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'August Joiners',
                        data: productAugJoiners,
                        backgroundColor: colors.augJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'September Joiners',
                        data: productSepJoiners,
                        backgroundColor: colors.sepJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'October Joiners',
                        data: productOctJoiners,
                        backgroundColor: colors.octJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'November Joiners',
                        data: productNovJoiners,
                        backgroundColor: colors.novJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'December Joiners',
                        data: productDecJoiners,
                        backgroundColor: colors.decJoiners,
                        borderWidth: 0,
                        borderRadius: { topLeft: 8, topRight: 8 },
                        borderSkipped: false
                    }
                ]
            },
            plugins: [{
                id: 'topLabelsStackAccurate',
                afterDatasetsDraw(chart) {
                    const { ctx, scales: { x, y } } = chart;
                    ctx.save();
                    ctx.font = 'bold 12px Segoe UI';
                    ctx.fillStyle = '#1e293b';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';

                    const lastDatasetIndex = chart.data.datasets.length - 1;

                    chart.data.labels.forEach((_, i) => {
                        // total = sum of stacked values (what is actually drawn)
                        const total = chart.data.datasets.reduce((sum, ds) => sum + (Number(ds.data[i]) || 0), 0);

                        // get the real top of the stack using the last dataset bar element
                        const meta = chart.getDatasetMeta(lastDatasetIndex);
                        const bar = meta.data[i];
                        if (!bar) return;

                        const topY = bar.getProps(['y'], true).y; // y-position of top of stack
                        const xPos = x.getPixelForValue(i);

                        ctx.fillText(total.toFixed(1) + 'M', xPos, topY - 6);
                    });

                    ctx.restore();
                }
            }],
            options: {
                responsive: true,
                maintainAspectRatio: true,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { 
                        position: 'top', 
                        labels: { 
                            boxWidth: 12, 
                            font: { size: 10, weight: '600' }, 
                            padding: 10,
                            usePointStyle: true,
                            pointStyle: 'circle'
                        } 
                    },
                    tooltip: {
                        position: 'nearest',
                        yAlign: 'top',
                        xAlign: 'center',
                        caretPadding: 8,
                        backgroundColor: 'rgba(30, 41, 59, 0.98)',
                        padding: 14,
                        bodyFont: { size: 11, family: 'monospace' },
                        callbacks: {
                            title: function(items) {
                                const idx = items[0].dataIndex;
                                const lines = [
                                    items[0].label + ' | Product+PS',
                                    'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
                                    'Total: ' + productTotal[idx].toFixed(2) + 'M',
                                    '  MEA Focus: ' + productFocus[idx].toFixed(2) + 'M',
                                    '  RC MEA: ' + productRC[idx].toFixed(2) + 'M',
                                    '',
                                    'April Baseline: ' + productCohort[idx].toFixed(2) + 'M'
                                ];
                                if (idx > 0) {
                                    const newAcc = productNewAccounts[idx];
                                    if (newAcc < 1) {
                                        lines.push('New Accounts: ' + (newAcc * 1000).toFixed(0) + 'K');
                                    } else {
                                        lines.push('New Accounts: ' + newAcc.toFixed(2) + 'M');
                                    }
                                }
                                return lines;
                            },
                            label: function(c) {
                                if (c.parsed.y === 0) return null;
                                const val = c.parsed.y;
                                // Format as K if less than 1M
                                if (val < 1) {
                                    return c.dataset.label + ': ' + (val * 1000).toFixed(0) + 'K';
                                }
                                return c.dataset.label + ': ' + val.toFixed(2) + 'M';
                            }
                        }
                    }
                },
                scales: {
                    x: { stacked: true, grid: { display: false }, ticks: { font: { weight: 'bold', size: 12 } } },
                    y: { 
                        stacked: true, 
                        beginAtZero: true, 
                        max: 68, 
                        ticks: { 
                            callback: v => '' + v + 'M',
                            font: { size: 11 },
                            color: '#64748b'
                        },
                        grid: { color: 'rgba(148, 163, 184, 0.1)' }
                    }
                }
            }
        });
        
        // Chart 4: Consumables Stacked (SAME HEIGHT AS TOTAL)
        new Chart(document.getElementById('consumablesChart'), {
            type: 'bar',
            data: {
                labels: months,
                datasets: [
                    {
                        label: 'April Cohort',
                        data: consumablesCohort,
                        backgroundColor: colors.aprilCohort,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'May Joiners',
                        data: consumablesMayJoiners,
                        backgroundColor: colors.mayJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'June Joiners',
                        data: consumablesJunJoiners,
                        backgroundColor: colors.junJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'July Joiners',
                        data: consumablesJulJoiners,
                        backgroundColor: colors.julJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'August Joiners',
                        data: consumablesAugJoiners,
                        backgroundColor: colors.augJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'September Joiners',
                        data: consumablesSepJoiners,
                        backgroundColor: colors.sepJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'October Joiners',
                        data: consumablesOctJoiners,
                        backgroundColor: colors.octJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'November Joiners',
                        data: consumablesNovJoiners,
                        backgroundColor: colors.novJoiners,
                        borderWidth: 0,
                        borderRadius: 0,
                        borderSkipped: false
                    },
                    {
                        label: 'December Joiners',
                        data: consumablesDecJoiners,
                        backgroundColor: colors.decJoiners,
                        borderWidth: 0,
                        borderRadius: { topLeft: 8, topRight: 8 },
                        borderSkipped: false
                    }
                ]
            },
            plugins: [{
                id: 'topLabelsStackAccurate',
                afterDatasetsDraw(chart) {
                    const { ctx, scales: { x, y } } = chart;
                    ctx.save();
                    ctx.font = 'bold 12px Segoe UI';
                    ctx.fillStyle = '#1e293b';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';

                    const lastDatasetIndex = chart.data.datasets.length - 1;

                    chart.data.labels.forEach((_, i) => {
                        // total = sum of stacked values (what is actually drawn)
                        const total = chart.data.datasets.reduce((sum, ds) => sum + (Number(ds.data[i]) || 0), 0);

                        // get the real top of the stack using the last dataset bar element
                        const meta = chart.getDatasetMeta(lastDatasetIndex);
                        const bar = meta.data[i];
                        if (!bar) return;

                        const topY = bar.getProps(['y'], true).y; // y-position of top of stack
                        const xPos = x.getPixelForValue(i);

                        ctx.fillText(total.toFixed(1) + 'M', xPos, topY - 6);
                    });

                    ctx.restore();
                }
            }],
            options: {
                responsive: true,
                maintainAspectRatio: true,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { 
                        position: 'top', 
                        labels: { 
                            boxWidth: 12, 
                            font: { size: 10, weight: '600' }, 
                            padding: 10,
                            usePointStyle: true,
                            pointStyle: 'circle'
                        } 
                    },
                    tooltip: {
                        position: 'nearest',
                        yAlign: 'top',
                        xAlign: 'center',
                        caretPadding: 8,
                        backgroundColor: 'rgba(30, 41, 59, 0.98)',
                        padding: 14,
                        bodyFont: { size: 11, family: 'monospace' },
                        callbacks: {
                            title: function(items) {
                                const idx = items[0].dataIndex;
                                const lines = [
                                    items[0].label + ' | Consumables',
                                    'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€',
                                    'Total: ' + consumablesTotal[idx].toFixed(2) + 'M',
                                    '  MEA Focus: ' + consumablesFocus[idx].toFixed(2) + 'M',
                                    '  RC MEA: ' + consumablesRC[idx].toFixed(2) + 'M',
                                    '',
                                    'April Baseline: ' + consumablesCohort[idx].toFixed(2) + 'M'
                                ];
                                if (idx > 0) {
                                    const newAcc = consumablesNewAccounts[idx];
                                    if (newAcc < 0.001 && newAcc > 0) {
                                        lines.push('New Accounts: ' + (newAcc * 1000).toFixed(0) + 'K');
                                    } else if (newAcc < 1) {
                                        lines.push('New Accounts: ' + (newAcc * 1000).toFixed(0) + 'K');
                                    } else if (newAcc === 0) {
                                        lines.push('New Accounts: 0.00');
                                    } else {
                                        lines.push('New Accounts: ' + newAcc.toFixed(2) + 'M');
                                    }
                                }
                                return lines;
                            },
                            label: function(c) {
                                if (c.parsed.y === 0) return null;
                                const val = c.parsed.y;
                                // Format as K if less than 1M
                                if (val < 1) {
                                    return c.dataset.label + ': ' + (val * 1000).toFixed(0) + 'K';
                                }
                                return c.dataset.label + ': ' + val.toFixed(2) + 'M';
                            }
                        }
                    }
                },
                scales: {
                    x: { stacked: true, grid: { display: false }, ticks: { font: { weight: 'bold', size: 12 } } },
                    y: { 
                        stacked: true, 
                        beginAtZero: true, 
                        max: 12, 
                        ticks: { 
                            callback: v => '' + v + 'M',
                            font: { size: 11 },
                            color: '#64748b'
                        },
                        grid: { color: 'rgba(148, 163, 184, 0.1)' }
                    }
                }
            }
        });
        
        // Chart 5: GC Person-wise
        new Chart(document.getElementById('gcPersonChart'), {
            type: 'bar',
            data: {
                labels: gcPersons,
                datasets: [
                    {
                        label: 'April',
                        data: gcApril,
                        backgroundColor: colors.aprilCohort + 'cc',
                        borderRadius: 6
                    },
                    {
                        label: 'December',
                        data: gcDec,
                        backgroundColor: '#eab308cc',
                        borderRadius: 6
                    },
                    {
                        label: 'YTD Total',
                        data: gcYTD,
                        backgroundColor: colors.mayJoiners + 'aa',
                        borderRadius: 6
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: {
                    legend: { position: 'top', labels: { boxWidth: 15, font: { size: 11 }, padding: 15 } },
                    tooltip: {
                        backgroundColor: 'rgba(30, 41, 59, 1)',
                        padding: 14,
                        callbacks: { label: ctx => ctx.dataset.label + ': ' + ctx.parsed.x.toFixed(2) + 'M' }
                    }
                },
                scales: {
                    x: { beginAtZero: true, ticks: { callback: v => v + 'M' } },
                    y: { ticks: { font: { size: 11, weight: '600' } } }
                }
            }
        });
        
        // Chart 6: RC Person-wise
        new Chart(document.getElementById('rcPersonChart'), {
            type: 'bar',
            data: {
                labels: rcPersons,
                datasets: [
                    {
                        label: 'April',
                        data: rcApril,
                        backgroundColor: colors.aprilCohort + 'cc',
                        borderRadius: 6
                    },
                    {
                        label: 'December',
                        data: rcDec,
                        backgroundColor: '#eab308cc',
                        borderRadius: 6
                    },
                    {
                        label: 'YTD Total',
                        data: rcYTD,
                        backgroundColor: colors.mayJoiners + 'aa',
                        borderRadius: 6
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: {
                    legend: { position: 'top', labels: { boxWidth: 15, font: { size: 11 }, padding: 15 } },
                    tooltip: {
                        backgroundColor: 'rgba(30, 41, 59, 1)',
                        padding: 14,
                        callbacks: { label: ctx => ctx.dataset.label + ': ' + ctx.parsed.x.toFixed(2) + 'M' }
                    }
                },
                scales: {
                    x: { beginAtZero: true, ticks: { callback: v => v + 'M' } },
                    y: { ticks: { font: { size: 11, weight: '600' } } }
                }
            }
        });
    </script>
</body>
</html>
